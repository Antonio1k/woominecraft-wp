window.WooMinecraft=function(e,n,o){var t={};return t.l10n=woominecraft||{},t.cache=function(){t.$body=o("body"),t.$nonce=t.$body.find("#woo_minecraft_nonce"),t.$resend_donations=t.$body.find("#resendDonations")},t.init=function(){t.cache(),t.$body.on("click",".woo_minecraft_reset",t.resetForm),t.$body.on("click",".wmc_add_server",t.addRow),t.$body.on("click",".wmc_delete_server",t.removeRow),t.l10n.player_id?t.$resend_donations.on("click",t.resend_donations):t.$resend_donations.prop("disabled",!0)},t.curParent=function(e){var n=o(e),t=n.closest("table.woominecraft");return!!t.length&&t},t.addRow=function(e){e.preventDefault();var n=t.curParent(this);if(!n)return!1;var o=n.find("tbody tr:first");if(!o)return!1;var r=o.clone();r.find(":text").val(""),o.parent("tbody").append(r),t.reindexRows(n)},t.removeRow=function(n){n.preventDefault();var r=t.curParent(this);if(!r)return e.console.trace(r),!1;var i=r.find("tbody tr").length;return 0==i-1?(alert(t.l10n.must_have_single),!1):void o(this).closest("tr.row").fadeOut(200,function(){o(this).remove(),t.reindexRows(r)})},t.reindexRows=function(e){var n=e.find("tbody tr");return!!n&&void n.each(function(e){o(this).find(":text").each(function(){var n=o(this).attr("name");n=n.replace(/\[([0-9]+)\]/,"["+e+"]"),o(this).attr("name",n)}),o(this).find("select").each(function(){var n=o(this).attr("name");n=n.replace(/\[([0-9]+)\]/,"["+e+"]"),o(this).attr("name",n)})})},t.resend_donations=function(e){e.preventDefault();var n=o("select.wmc-server-select");return!(!n||""==n.val())&&(t.$resend_donations.prop("disabled",!0),void o.ajax({url:ajaxurl,data:{action:"wmc_resend_donations",order_id:t.l10n.order_id,player_id:t.l10n.player_id,server:n.val()},dataType:"json",method:"POST"}).done(t.xhrDone))},t.xhrDone=function(e,n,o){e.success&&alert(t.l10n.donations_resent),t.$resend_donations.prop("disabled",!1)},t.resetForm=function(e){e.preventDefault();var n=confirm(t.l10n.confirm);n&&o(this).closest(".form-fields").find("span").not(".woo_minecraft_copyme, .woocommerce-help-tip").fadeOut(200,function(){o(this).remove(),o("#variable_product_options .woocommerce_variations :input").trigger("change")})},t.log=function(){t.l10n.script_debug&&e.console&&e.console.log(Array.prototype.slice.call(arguments))},o(n).ready(t.init),t}(window,document,jQuery);